---
title: "esm206_assignment4"
author: "Caroline Shepherd"
date: "11/6/2021"
output: html_document
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE)
```

## Introduction

The data in this report comes from the Bonanza Creek Experimental Forest and uses data from 1999 - 2012. This report explores the relationship between juvenile snowshoe hares and their weight, hindfoot length, and amount of hares per year. Snowshoe hares experience fluctuations in population, and this fluctuation is being studied in the northern boreal forests in Alaska. This study aimed to collect data on snowshoe hares at the juvenile and adult stages, and with a variety of body measurements including body weight (g) and hindfoot length (mm).

## Data and Analyses

This code wrangles, visualizes, and summarizes snowshoe hare data from the Bonanza Creek Experiments conducted in Alaska from 1999 to 2012. Individual counts of juvenile snowshoe hares are depicted, and summary statistics are explored for the weight of juveniles hares, grouped by sex. The relationship between hindfoot length (mm), body weight (g), and sex is also explored in this code.

Data source: Kielland, K., F.S. Chapin, R.W. Ruess, and Bonanza Creek LTER. 2017. Snowshoe hare physical data in Bonanza Creek Experimental Forest: 1999-Present ver 22. Environmental Data Initiative. https://doi.org/10.6073/pasta/03dce4856d79b91557d8e6ce2cbcdc14


```{r} 
library(tidyverse) # Install Packages
library(here)
library(janitor)
library(kableExtra)
library(lubridate)
library(effsize)
library(ggbeeswarm)
```


```{r}
hares <- read_csv(here("data", "bonanza_hares.csv")) # Read in the data
```
## Initial Juvenile Hare Investigation
```{r}
juvenile_hares <- hares %>% # Create new dataframe
  filter(age =="j") %>% # Filter for only juvenile hares
  mutate(date_new = mdy(date)) %>% # Create a new date class
  mutate(year = year(date_new)) %>% # Create a new date class for a 'year' column
  group_by(year) # Group by year

juvenile_hares_count <- juvenile_hares %>% 
  summarize(count = n()) # Summarize the count of juvenile hares

ggplot(data = juvenile_hares, aes(x = year)) +  # Create histogram showing amount of juvenile hares by year
         geom_histogram(bins = 15) +
  labs(x = "Count of Juvenile Snowshoe Hares",
       y = "Year",
       title = "Annual Amount of Juvenile Snowshoe Hares Recorded") +
  theme_bw(plot.caption = element_text(hjust = 0))
```

```{r}
ggplot(data = juvenile_hares, aes(x = sex, y = weight)) + # Create
  geom_beeswarm(aes(color = sex)) +
  facet_wrap(~ grid) +
  scale_color_manual(values = c("cyan4", "coral")) +
  geom_boxplot(fill = NA, width = 0.5, outlier.color = NA) +
  theme_bw()
```
## Juvenile Weight Comparison

```{r}
juvenile_hares_summary <- juvenile_hares %>% 
  group_by(sex) %>% 
  summarize(mean = round(mean(weight, na.rm = TRUE), 2),
            median = round(median(weight, na.rm = TRUE), 2),
            sd = round(sd(weight, na.rm = TRUE), 2),
            sample_size = n())

juvenile_male_sample <- juvenile_hares %>% 
  filter(sex == "m") %>% 
  pull(weight)

juvenile_female_sample <- juvenile_hares %>% 
  filter(sex == "f") %>% 
  pull(weight)

juvenile_hares_ttest <- t.test(juvenile_male_sample, juvenile_female_sample)

juvenile_hares_summary %>% 
  kable(col.names = c("Sex", "Mean Weight (g)", "Median Weight (g)", "Standard Deviation (g)", "Sample Size"),
        caption = "Juvenile Hare Weight (g) Comparison")

juvenile_effsize <- cohen.d(juvenile_male_sample, juvenile_female_sample, na.rm = TRUE)

```

## Relationship between juvenile hare weight (g) and hind foot length (mm)

```{r}
ggplot(data = juvenile_hares, aes(x = hindft, y = weight)) +
  geom_point(aes(color = sex))  +
  geom_smooth(method = "lm", se = FALSE, color = "gray30") +
  labs(x = "Hindfoot Length (mm)", 
       y = "Weight (g)")
```
**Figure 3.** Relationship between hindfoot length (mm) and weight (g) for juvenile hares. Points indicate individual hare measurements (female hare measurement = coral pink; male hare measurements = teal green).


